# 技术方案设计

## 架构概述

添加链接功能将包括前端和后端两部分实现：
- 前端：添加用户界面元素（按钮、模态框、表单）和交互逻辑
- 后端：添加API端点，处理添加链接的请求并调用飞书API将数据保存到多维表格

## 技术栈

- 前端：HTML, CSS, JavaScript, Bootstrap Icons
- 后端：Node.js, Express, Axios
- 外部服务：飞书开放平台API

## 数据库/接口设计

### 后端API设计

#### 1. POST /api/links

**功能：** 添加新的网站链接到飞书多维表格

**请求参数：**
```json
{
  "name": "网站名称",
  "url": "网站网址",
  "category": "分类名称",
  "sort": 排序数字 (可选)
}
```

**响应格式：**
```json
{
  "success": true/false,
  "message": "操作结果描述",
  "data": 添加的记录数据 (成功时)
}
```

### 飞书API调用设计

后端API将调用飞书多维表格的创建记录API：
```
POST https://open.feishu.cn/open-apis/bitable/v1/apps/{APP_TOKEN}/tables/{TABLE_ID}/records
```

请求体格式：
```json
{
  "fields": {
    "分类": "分类名称",
    "排序": 排序数字,
    "站点名称": "网站名称",
    "网址": {
      "link": "网站网址",
      "text": "网站名称"
    }
  }
}
```

## 前端实现方案

### 1. 用户界面元素

- 在主内容区添加一个明显的添加按钮
- 创建一个模态框，包含以下表单字段：
  - 网站名称（文本输入框）
  - 网站网址（文本输入框）
  - 分类选择（下拉菜单，选项来自现有分类）
  - 排序（数字输入框，可选）
  - 保存和取消按钮

### 2. 交互逻辑

- 点击添加按钮时，显示模态框
- 输入表单数据时，进行实时验证
- 点击保存按钮时：
  1. 验证表单数据
  2. 调用后端API /api/links
  3. 根据API响应显示成功或失败提示
  4. 成功后刷新导航数据并关闭模态框
- 点击取消按钮或模态框外部时，关闭模态框

## 后端实现方案

### 1. 添加API端点

在server.js中添加POST /api/links端点，实现以下逻辑：
- 解析请求体中的链接数据
- 验证数据的有效性
- 获取飞书API的访问令牌
- 调用飞书多维表格API创建记录
- 返回适当的响应

### 2. 错误处理

- 处理请求数据验证错误
- 处理飞书API调用错误
- 提供详细的错误信息给前端

## 安全性考虑

- 验证所有用户输入的数据
- 限制请求频率，防止滥用
- 保护敏感信息，如API密钥
- 设置适当的CORS策略

## 测试策略

- 测试表单验证功能
- 测试添加成功和失败的场景
- 测试响应式设计，确保在移动设备上正常工作